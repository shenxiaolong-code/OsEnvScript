# WinScript

WinScript 是一个 Windows 批处理脚本编程支持库，被广泛应用于我的自动化工具和日常工作流中。

# 设计目的

本库用于日常工作自动化：

- 通过右键菜单快速执行常用日常任务。
- 一键收集客户环境下所有必要信息，无需复杂指令。

- 类似于许多高级编程语言，本库以“函数+输入/输出参数”的方式提供功能，代码高度复用。

- 结构关系：模块（module）→ 函数/对象（function/object）→ 输入参数（input parameter）→ 输出参数（output parameter）+ 返回码（return code）。

---

## WinDbg 增强脚本

本脚本集大幅提升了 WinDbg 在高频故障分析场景下的调试体验：

- **右键菜单集成常用操作**：一键执行复杂调试任务，无需记忆繁琐命令。
- **场景化专用分析脚本**：内置针对二次异常调用栈丢失、死锁、崩溃、内存泄漏等典型场景的专用分析命令。用户可通过鼠标双击命令或分步提示，快速定位问题。
- **自定义高频命令面板**：将常用或难记的长命令集成到自定义面板，支持鼠标双击执行，极大提升效率。
- **自动加载专属调试配置**：可根据目标程序自动加载专属调试配置，实现零切换成本，一站式入口。

**实战验证**：已在生产环境中日均高效处理 50+ dump 文件，大幅提升团队问题定位与响应速度。

---

## Linux GDB 增强脚本

本套脚本通过原生 GDB + Bash 实现了对标 Windows WinDbg 的高效跨平台调试体验：

- **编辑器无缝集成**：GDB 调试时可自动在 VS Code 或任意编辑器中打开对应源码行。
- **跨机源代码联动**：支持在机器 A 调试时，自动在机器 B 上打开对应源代码，适配远程开发场景。
- **极致响应速度**：核心操作（如单步调试）响应速度远超 VS Code 内置调试器，实测单步操作 <50ms。
- **轻量级实现**：90% 功能为纯 Bash 实现，少量功能用 Python 辅助（核心功能无 Python 依赖）。

**状态**：已在生产环境中实际使用，近期将开源发布。

---

# 脚本特性概览

- **自文档化**：可自动生成模块 API 文档。
- **调试支持**：帮助开发者快速定位问题。
    1. 支持打印函数调用栈。
    2. 出错时自动暂停。
    3. 出错时自动以彩色文本打印源码路径、行号和出错代码。
- **用例示例**：帮助单元测试和提升易用性。
- **易于维护和更新**：无冗余代码。

---

# 使用示例

详见：[使用示例](https://github.com/ShenXiaolong1976/WinScript/tree/master/common/userCases)
